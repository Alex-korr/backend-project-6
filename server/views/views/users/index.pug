extends ../layout

block content
  if success && success.length
    each msg in success
      div.alert.alert-success.mt-3(style='background: #e3f2fd; color: #1976d2; border: 1px solid #90caf9;')= msg
  if error && error.length
    each msg in error
      div.alert.alert-danger.mt-3= msg
  if validationErrors && Object.keys(validationErrors).length > 0
    each err in Object.values(validationErrors)
      .invalid-feedback.d-block.alert.alert-danger.py-1.px-2.mb-2(style='font-size: 0.85rem; max-width: 400px;')= err
  .d-flex.justify-content-between.align-items-center.mb-3
    h1= t('layouts.application.users')
    a.btn.btn-primary(href=`/users/new?lang=${typeof currentLang !== 'undefined' ? currentLang : 'en'}`)= t('users.index.newUser')
  if users.length
    table.table.table-striped.table-hover.mt-4
      thead
        tr
          if typeof currentLang !== 'undefined' && currentLang === 'ru'
            th Имя
            th Email
            th
            th
          else
            th Name
            th Email
            th
            th
      tbody
        each user in users
          tr
            td
              | #{user.firstName} #{user.lastName}
            td= user.email
            td
              if currentUser && (currentUser.id === user.id || currentUser.role === 'admin')
                a.btn.btn-sm.btn-outline-primary(href=`/users/${user.id}/edit?lang=${typeof currentLang !== 'undefined' ? currentLang : 'en'}`)= t('users.index.Edit')
            td
              if currentUser && (currentUser.id === user.id || (currentUser.role === 'admin' && user.role === 'user'))
                form(action=`/users/${user.id}/delete?lang=${typeof currentLang !== 'undefined' ? currentLang : 'en'}`, method='post', style='display: inline;')
                  button.btn.btn-sm(type='submit' style='background: #fff; color: #e57373; border: 1px solid #e57373;')= t('users.index.Delete')
  else
    div.alert.alert-info.mt-4= t('noUsersYet')